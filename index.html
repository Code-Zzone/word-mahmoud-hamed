<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø­Ø±Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ - Ù†Ø³Ø®Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„</title>
    <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…ÙƒØªØ¨Ø© Ø®Ø·ÙˆØ· Ø¹Ø±Ø¨ÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø© -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Cairo:wght@400;600;700&family=Tajawal:wght@400;700&family=Almarai:wght@400;800&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* ========================================= */
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
        /* ========================================= */
        :root {
            --primary: #1976d2; /* Ø£Ø²Ø±Ù‚ Ø§Ø­ØªØ±Ø§ÙÙŠ */
            --bg: #eceff1;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding-top: 140px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø´Ø±ÙŠØ· */
            direction: rtl;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª */
        .toolbar {
            position: fixed; top: 0; left: 0; right: 0;
            height: 120px; background: white;
            border-bottom: 3px solid var(--primary);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex; gap: 15px; padding: 5px 20px;
            align-items: center; overflow-x: auto;
        }

        .group {
            display: flex; flex-direction: column; align-items: center;
            border-left: 1px solid #ddd; padding-left: 15px; min-width: max-content;
        }
        .group-title { font-size: 11px; color: #78909c; margin-bottom: 5px; font-weight: bold; }
        .row { display: flex; gap: 5px; align-items: center; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        button, select {
            padding: 6px 10px; border: 1px solid #cfd8dc; background: #fff;
            cursor: pointer; border-radius: 4px; font-family: 'Cairo'; font-size: 13px;
            transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 5px;
        }
        button:hover { background: #e3f2fd; border-color: var(--primary); }
        
        button.primary-btn { background: var(--primary); color: white; border: none; }
        button.danger-btn { background: #ffebee; color: #c62828; border-color: #ffcdd2; }
        
        button.active-btn { background: #bbdefb; border-color: var(--primary); }

        /* Ø§Ù„ÙˆØ±Ù‚Ø© */
        .workspace {
            display: flex; flex-direction: column; align-items: center; gap: 30px; padding-bottom: 50px;
        }
        .page-container { position: relative; }
        .page-header {
            display: flex; justify-content: space-between; align-items: center;
            background: #546e7a; color: white; padding: 5px 15px;
            border-radius: 5px 5px 0 0; font-size: 12px;
        }
        .a4-page {
            width: 210mm; min-height: 297mm;
            background: white; padding: 20mm;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            position: relative; box-sizing: border-box;
        }

        /* Ø§Ù„ÙƒØªÙ„ Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ */
        .editable-block {
            position: relative; border: 1px dashed transparent; margin-bottom: 5px;
            min-height: 30px; /* Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø± */
        }
        .editable-block:hover { border-color: #b0bec5; }
        
        .block-tools {
            position: absolute; right: -35px; top: 0;
            display: none; flex-direction: column; gap: 3px;
        }
        .editable-block:hover .block-tools { display: flex; }
        .mini-btn { width: 28px; height: 28px; border-radius: 50%; padding: 0; }

        /* ========================================= */
        /* Ø¬Ø¯Ø§ÙˆÙ„ Excel Style */
        /* ========================================= */
        table { width: 100%; border-collapse: collapse; table-layout: fixed; margin: 0 auto; }
        th, td { border: 1px solid #bbb; padding: 5px; position: relative; word-wrap: break-word; }
        th { background-color: #f5f5f5; font-weight: bold; text-align: center; }
        
        .resizer {
            position: absolute; left: 0; top: 0; bottom: 0; width: 5px;
            cursor: col-resize; user-select: none; z-index: 10;
        }
        .selected { outline: 2px solid var(--primary); background-color: rgba(25, 118, 210, 0.1); }

        /* ========================================= */
        /* Ø§Ù„ØµÙˆØ± */
        /* ========================================= */
        .resizable-img-wrapper {
            display: inline-block; position: relative; border: 1px solid transparent;
            vertical-align: middle;
        }
        .resizable-img-wrapper:hover { border: 1px dashed var(--primary); }
        .resizable-img-wrapper img { display: block; max-width: 100%; pointer-events: none; }
        .img-handle {
            width: 12px; height: 12px; background: var(--primary);
            position: absolute; bottom: -6px; left: -6px; cursor: sw-resize;
            display: none; border-radius: 50%;
        }
        .resizable-img-wrapper:hover .img-handle { display: block; }

        /* Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
        @media print {
            .toolbar, .page-header, .block-tools, .img-handle { display: none !important; }
            .page-container { display: none; }
            .page-container.print-active { display: block; position: absolute; top: 0; left: 0; width: 100%; }
            .a4-page { box-shadow: none; margin: 0; width: 100%; height: auto; }
            .editable-block { border: none !important; }
        }
    </style>
</head>
<body>

    <!-- Toolbar -->
    <div class="toolbar">
        <!-- Ø®ÙÙŠ: Ù„Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± -->
        <input type="file" id="logoInput" accept="image/*" style="display: none;" onchange="handleImageUpload(this)">

        <div class="group">
            <span class="group-title">Ø¥Ø¯Ø±Ø§Ø¬</span>
            <div class="row">
                <button onclick="addBlock('table')" class="primary-btn">â–¦ Ø¬Ø¯ÙˆÙ„</button>
                <button onclick="document.getElementById('logoInput').click()" style="background:#e1f5fe; color:#0277bd;">ğŸ–¼ï¸ ØµÙˆØ±Ø©</button>
                <button onclick="addBlock('heading')" style="font-weight:bold;">H Ø¹Ù†ÙˆØ§Ù†</button>
                <button onclick="addBlock('text')">ğŸ“ Ù†Øµ</button>
            </div>
        </div>

        <div class="group">
            <span class="group-title">Ø§Ù„Ø®Ø· ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚</span>
            <div class="row">
                <select id="fontSelect" onchange="changeFont(this.value)" style="width: 110px;">
                    <option value="Cairo">Ø®Ø· Cairo</option>
                    <option value="Amiri">Ø®Ø· Ø£Ù…ÙŠØ±ÙŠ</option>
                    <option value="Tajawal">Ø®Ø· ØªØ¬ÙˆØ§Ù„</option>
                    <option value="Almarai">Ø®Ø· Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ</option>
                    <option value="Reem Kufi">Ø®Ø· ÙƒÙˆÙÙŠ</option>
                    <option value="Arial">Arial</option>
                </select>
            </div>
            <div class="row" style="margin-top:5px;">
                <button onclick="document.execCommand('bold')" title="Ø¹Ø±ÙŠØ¶"><b>B</b></button>
                <button onclick="document.execCommand('italic')" title="Ù…Ø§Ø¦Ù„"><i>I</i></button>
                <input type="number" id="fontSize" value="14" style="width:50px; text-align:center" onchange="changeSize(this.value)">
                <span style="font-size:11px">px</span>
            </div>
        </div>

        <div class="group">
            <span class="group-title">Ù…Ø­Ø§Ø°Ø§Ø©</span>
            <div class="row">
                <button onclick="setAlignment('right')" title="ÙŠÙ…ÙŠÙ†">â¡ï¸</button>
                <button onclick="setAlignment('center')" title="ØªÙˆØ³Ø·">âºï¸</button>
                <button onclick="setAlignment('left')" title="ÙŠØ³Ø§Ø±">â¬…ï¸</button>
            </div>
        </div>

        <div class="group">
            <span class="group-title">Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„</span>
            <div class="row">
                <button onclick="execTable('addrow')">â• ØµÙ</button>
                <button onclick="execTable('addcol')">â• Ø¹Ù…ÙˆØ¯</button>
                <button onclick="deleteFullTable()" class="danger-btn" title="Ø­Ø°Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„">ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ø¯ÙˆÙ„</button>
            </div>
            <div class="row" style="margin-top:5px;">
                <input type="color" id="colorInput" value="#fff176" title="Ù„ÙˆÙ† Ø§Ù„ØªÙ…ÙŠÙŠØ²">
                <button onclick="applyColor('row')">Ù„ÙˆÙ† ØµÙ</button>
                <button onclick="autoNumber()">ğŸ”¢ ØªØ±Ù‚ÙŠÙ…</button>
            </div>
        </div>

        <div class="group" style="margin-right:auto;">
             <button onclick="addPage()" style="background:#37474f; color:#fff;">ğŸ“„ ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø© +</button>
        </div>
    </div>

    <!-- Workspace -->
    <div class="workspace" id="workspace">
        <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: ÙØ§Ø±ØºØ© ÙˆØ¬Ø§Ù‡Ø²Ø© -->
        <div class="page-container" id="page1">
            <div class="page-header">
                <span>ØµÙØ­Ø© 1</span>
                <button onclick="printThisPage('page1')" class="primary-btn" style="padding:2px 10px; font-size:11px;">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            </div>
            <div class="a4-page">
                <!-- ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŒ Ø§Ù„ØµÙØ­Ø© Ø¨ÙŠØ¶Ø§Ø¡ ØªÙ…Ø§Ù…Ø§Ù‹ -->
                <div class="editable-block" contenteditable="true" style="color:#aaa; text-align:center; padding:20px;">
                    <p>Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„ÙƒØªØ§Ø¨Ø© Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø¥Ø¯Ø±Ø§Ø¬...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===============================================
        // Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¹Ø§Ù… ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        // ===============================================
        let selectedCell = null;
        let selectedTable = null;
        let activeBlock = null; // Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù†Ø´Ø· (Ø¬Ø¯ÙˆÙ„ØŒ ØµÙˆØ±Ø©ØŒ Ù†Øµ)

        document.addEventListener('click', function(e) {
            // ØªØªØ¨Ø¹ Ø§Ù„Ø®Ù„ÙŠØ© ÙˆØ§Ù„Ø¬Ø¯ÙˆÙ„
            if(e.target.closest('td, th')) {
                if(selectedCell) selectedCell.classList.remove('selected');
                selectedCell = e.target.closest('td, th');
                selectedTable = selectedCell.closest('table');
                selectedCell.classList.add('selected');
            }
            
            // ØªØªØ¨Ø¹ Ø§Ù„Ø¨Ù„ÙˆÙƒ Ø§Ù„Ù†Ø´Ø· (Ù„Ù„Ù…Ø­Ø§Ø°Ø§Ø©)
            if(e.target.closest('.editable-block')) {
                activeBlock = e.target.closest('.editable-block');
            }
        });

        // ===============================================
        // Ø§Ù„Ù…Ø­Ø§Ø°Ø§Ø© ÙˆØ§Ù„Ø®Ø·ÙˆØ· (Ø¬Ø¯ÙŠØ¯)
        // ===============================================
        function setAlignment(align) {
            // Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©: 1. Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø­Ø¯Ø¯ 2. Ø§Ù„Ø¨Ù„ÙˆÙƒ Ø§Ù„Ù†Ø´Ø·
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø­Ø¯Ø¯ (Ø¯Ø§Ø®Ù„ Ø®Ù„ÙŠØ© Ø£Ùˆ ÙÙ‚Ø±Ø©)
            document.execCommand('justify' + capitalize(align), false, null);

            // Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ø¨Ù„ÙˆÙƒ Ù†ÙØ³Ù‡ (Ù„Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØ§Ù„ØµÙˆØ±)
            if (activeBlock) {
                activeBlock.style.textAlign = align;
            }
        }

        function capitalize(s) { return s.charAt(0).toUpperCase() + s.slice(1); }

        function changeFont(fontName) {
            document.execCommand('fontName', false, fontName);
        }

        function changeSize(val) {
            // Ø·Ø±ÙŠÙ‚Ø© Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø­Ø¬Ù… Ø§Ù„Ø®Ø·
            const sel = window.getSelection();
            if (sel.rangeCount) {
                // Ù†Ø³ØªØ®Ø¯Ù… execCommand Ù„Ø¥Ù†Ø´Ø§Ø¡ span Ø«Ù… Ù†Ø¹Ø¯Ù„ Ø­Ø¬Ù…Ù‡
                document.execCommand('fontSize', false, '7');
                const fonts = document.querySelectorAll('font[size="7"]');
                fonts.forEach(f => {
                    f.removeAttribute('size');
                    f.style.fontSize = val + 'px';
                });
            }
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¬Ø±Ø¯ Ù…Ø¤Ø´Ø± Ø¯Ø§Ø®Ù„ Ø®Ù„ÙŠØ©
            if(selectedCell) selectedCell.style.fontSize = val + 'px';
        }

        // ===============================================
        // Ø§Ù„Ø¥Ø¯Ø±Ø§Ø¬ (Ø¹Ù†Ø§ÙˆÙŠÙ†ØŒ Ù†ØµÙˆØµØŒ Ø¬Ø¯Ø§ÙˆÙ„)
        // ===============================================
        function addBlock(type) {
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Ø§Ù„Ø£Ø®ÙŠØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹)
            const pages = document.querySelectorAll('.a4-page');
            const targetPage = pages[pages.length-1];

            const div = document.createElement('div');
            div.className = 'editable-block';
            
            // Ø²Ø± Ø§Ù„Ø­Ø°Ù
            div.innerHTML = `<div class="block-tools"><button class="mini-btn danger-btn" onclick="this.closest('.editable-block').remove()">X</button></div>`;

            if (type === 'table') {
                createResizableTable(div);
            } else if (type === 'text') {
                div.innerHTML += `<div contenteditable="true" style="padding:5px"><p>Ù†Øµ Ø¬Ø¯ÙŠØ¯...</p></div>`;
            } else if (type === 'heading') {
                div.innerHTML += `<h1 contenteditable="true" style="margin:5px 0; color:#333; text-align:center;">Ø¹Ù†ÙˆØ§Ù† Ø±Ø¦ÙŠØ³ÙŠ</h1>`;
            }

            targetPage.appendChild(div);
            // Scroll to bottom
            div.scrollIntoView({behavior:'smooth', block:'center'});
        }

        // ===============================================
        // ØµÙˆØ± (Image Logic)
        // ===============================================
        function handleImageUpload(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) { insertImage(e.target.result); };
                reader.readAsDataURL(input.files[0]);
            }
            input.value = ''; 
        }

        function insertImage(src) {
            const pages = document.querySelectorAll('.a4-page');
            const targetPage = pages[pages.length-1];

            const div = document.createElement('div');
            div.className = 'editable-block';
            div.style.textAlign = 'center'; // Ø§ÙØªØ±Ø§Ø¶ Ø§Ù„ØªÙˆØ³Ø·
            
            div.innerHTML = `
                <div class="block-tools"><button class="mini-btn danger-btn" onclick="this.closest('.editable-block').remove()">X</button></div>
                <div class="resizable-img-wrapper" style="width: 200px;">
                    <img src="${src}">
                    <div class="img-handle"></div>
                </div>
            `;
            targetPage.appendChild(div);
            initImageResizers();
        }

        function initImageResizers() {
            document.querySelectorAll('.img-handle').forEach(handle => {
                if(handle.dataset.active) return;
                handle.dataset.active = "true";
                
                let startX, startW, wrapper;
                handle.addEventListener('mousedown', e => {
                    e.preventDefault(); e.stopPropagation();
                    wrapper = handle.closest('.resizable-img-wrapper');
                    startX = e.clientX;
                    startW = parseInt(getComputedStyle(wrapper).width);
                    document.documentElement.addEventListener('mousemove', doDrag);
                    document.documentElement.addEventListener('mouseup', stopDrag);
                });
                
                function doDrag(e) {
                    // Ø³Ø­Ø¨ Ù„Ù„ÙŠØ³Ø§Ø± ÙŠØ²ÙŠØ¯ Ø§Ù„Ø¹Ø±Ø¶ (RTL)
                    const newW = startW + (startX - e.clientX);
                    if(newW > 20) wrapper.style.width = newW + 'px';
                }
                function stopDrag() {
                    document.documentElement.removeEventListener('mousemove', doDrag);
                    document.documentElement.removeEventListener('mouseup', stopDrag);
                }
            });
        }

        // ===============================================
        // Ø¬Ø¯Ø§ÙˆÙ„ (Excel Logic)
        // ===============================================
        function createResizableTable(container) {
            const table = document.createElement('table');
            table.innerHTML = `
                <thead>
                    <tr><th style="width:50px">Ù…</th><th style="width:200px">Ø§Ù„Ø¨ÙŠØ§Ù†</th><th style="width:100px">Ø§Ù„Ù‚ÙŠÙ…Ø©</th></tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td></td><td></td></tr>
                    <tr><td>2</td><td></td><td></td></tr>
                </tbody>
            `;
            table.querySelectorAll('td, th').forEach(c => c.contentEditable = true);
            container.appendChild(table);
            initTableResizers(table);
        }

        function initTableResizers(table) {
            const cols = table.querySelectorAll('th');
            cols.forEach(col => {
                if(col.querySelector('.resizer')) return;
                const resizer = document.createElement('div');
                resizer.className = 'resizer';
                resizer.contentEditable = false;
                col.appendChild(resizer);
                
                let x = 0, w = 0;
                resizer.addEventListener('mousedown', e => {
                    x = e.clientX;
                    w = parseInt(getComputedStyle(col).width);
                    document.addEventListener('mousemove', mm);
                    document.addEventListener('mouseup', mu);
                });
                const mm = e => { col.style.width = (w - (x - e.clientX)) + 'px'; };
                const mu = () => { document.removeEventListener('mousemove', mm); document.removeEventListener('mouseup', mu); };
            });
        }

        function deleteFullTable() {
            if(selectedTable && confirm('Ø­Ø°Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ')) {
                const block = selectedTable.closest('.editable-block');
                block ? block.remove() : selectedTable.remove();
                selectedTable = null; selectedCell = null;
            }
        }

        function execTable(act) {
            if(!selectedTable) return alert('Ø­Ø¯Ø¯ Ø¬Ø¯ÙˆÙ„Ø§Ù‹');
            if(act === 'addrow') {
                const r = selectedTable.insertRow(-1);
                for(let i=0; i<selectedTable.rows[0].cells.length; i++) {
                    let c = r.insertCell(); c.contentEditable=true; c.style.border='1px solid #bbb';
                }
            }
            if(act === 'addcol') {
                for(let r of selectedTable.rows) {
                    let c = r.insertCell(-1); c.contentEditable=true; c.style.border='1px solid #bbb';
                    if(r.rowIndex===0) { c.outerHTML='<th>Ø¬Ø¯ÙŠØ¯</th>'; setTimeout(()=>initTableResizers(selectedTable),50); }
                }
            }
        }

        function autoNumber() {
            if(!selectedTable) return;
            let idx = -1;
            selectedTable.querySelectorAll('th').forEach((th,i)=> { if(th.innerText.match(/Ù…|#/)) idx=i; });
            if(idx===-1) {
                for(let r of selectedTable.rows) {
                    let c = r.insertCell(0);
                    if(r.rowIndex===0) c.outerHTML='<th style="width:40px">Ù…</th>';
                    else { c.style.textAlign='center'; c.style.fontWeight='bold'; c.contentEditable=true; c.style.border='1px solid #bbb'; }
                }
                idx=0; setTimeout(()=>initTableResizers(selectedTable),50);
            }
            let n=1;
            for(let i=1; i<selectedTable.rows.length; i++) {
                if(selectedTable.rows[i].cells[idx]) selectedTable.rows[i].cells[idx].innerText = n++;
            }
        }

        function applyColor(type) {
            const c = document.getElementById('colorInput').value;
            if(type==='row' && selectedCell) {
                for(let cell of selectedCell.parentElement.cells) cell.style.backgroundColor = c;
            }
        }

        // ===============================================
        // ØµÙØ­Ø§Øª
        // ===============================================
        let pNum = 1;
        function addPage() {
            pNum++;
            const id = 'page'+pNum;
            const div = document.createElement('div');
            div.className='page-container'; div.id=id;
            div.innerHTML = `
                <div class="page-header"><span>ØµÙØ­Ø© ${pNum}</span><button onclick="printThisPage('${id}')" class="primary-btn" style="padding:2px 10px; font-size:11px;">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button></div>
                <div class="a4-page"><div class="editable-block" contenteditable="true" style="padding:10px"><p>ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©...</p></div></div>
            `;
            document.getElementById('workspace').appendChild(div);
            div.scrollIntoView({behavior:'smooth'});
        }

        function printThisPage(id) {
            document.querySelectorAll('.page-container').forEach(p => p.classList.remove('print-active'));
            document.getElementById(id).classList.add('print-active');
            window.print();
        }
    </script>
</body>
</html>
